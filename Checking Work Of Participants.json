{
  "name": "Checking Work Of Participants",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "=Instructions for the AI Agent:\n\nYou are an automated AI grader for programming challenges. Your task is to assess student submissions from Google Sheets and GitHub repositories. Follow these steps exactly:\n\nExtremely Important Notes:\n- A free tier of OpenAI Chat Model is being used here.\n- In the first run, only accept 3 request and process them, do the necessary steps.\n- Then wait for 20 seconds for limit to refresh.\n- Follow the instructions below then\n\nStep 1: Read Challenges\n\nAccess the Google Sheet Tool named \"Challenges\".\n\nExtract all challenges. Each challenge includes:\n\n- Challenge number\n- Challenge name\n- Challenge description (including examples, constraints, and hints)\n\nStore these challenges in memory for reference.\n\nStep 2: Read Student Submissions\n\nAccess the Google Sheet named \"Solution Submissions\".\n\nFor each newly added student:\n\n- Read the student's GitHub repository link.\n- Note the bonus deadline and bonus points if submitted before the deadline.\n\nStep 3: Visit Student Repository\n\nOnly access the student's specific repository.\n\nFor each challenge:\n\n- Look through all folders in the repository for files related to that challenge.\n- If no file is found for a challenge, skip it.\n\nStep 4: Assess Each Challenge\n\nFor each submitted solution:\n\nCorrectness:\n\n- Run the code against all examples from the challenge description.\n- Ensure outputs match the expected results exactly.\n\nAdditional Criteria:\n\n- Verify time complexity matches problem constraints.\n- Confirm function names, arguments, and requirements from the description.\n\nMarks:\n\n- Each challenge carries 2 marks.\n- Assign 2 marks if the solution passes all example tests.\n- Assign 0 marks if no file is submitted.\n- Assign 0.25 marks may be given if only some examples pass (optional).\n- Assign 0.5 if the code is written but due to some errors it is not running. Give 0 if the code has a lot of errors.\n\nStep 5: Apply Bonus Points\n\n- If the student submitted before the bonus deadline, add the predefined bonus points to their total.\n- Bonus points are added regardless of correctness.\n\nStep 6: Calculate Total Marks\n\n- Sum marks from all challenges.\n- Add bonus points.\n- Store total marks and individual question marks.\n\nStep 7: Update Google Sheet\n\nUse the \"UpdateSheetAfterCheckingCode\" tool for this.\n\nFor each student:\n\n- Update marks for each challenge.\n- Update bonus points.\n- Update total marks.\n- Add comments explaining:\n  - Why each mark was given\n  - Which examples passed or failed\n  - Any missing files\n  - Any issues with time complexity or function structure\n\nStep 8: Repeat\n\n- Repeat Steps 3â€“7 for every student submission in the sheet.\n\nImportant Notes:\n\n- Only assess files in the student's repository. Do not visit other repositories.\n- Comments must be clear and structured for each student.\n- Keep marks per question separate from bonus points for transparency.\n- Ensure all examples and functional requirements are strictly checked.",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "Process ONE student at a time. Use tools efficiently - fetch repository once, check files, grade solutions, update sheet. Minimize API calls by batching operations where possible.",
          "maxIterations": 3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        128,
        752
      ],
      "id": "45fdcf14-b63f-4bea-adb9-61ea9e15116f",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM",
          "mode": "list",
          "cachedResultName": "Participants Data",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1667173423,
          "mode": "list",
          "cachedResultName": "Solution Submissions",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM/edit#gid=1667173423"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {
            "row_number": "={{ $('Workflow Configuration').item.json.row_number }}"
          },
          "matchingColumns": [
            "Email address"
          ],
          "schema": [
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email address",
              "displayName": "Email address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email Address",
              "displayName": "Email Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Phone Number",
              "displayName": "Phone Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "GitHub Repository Link",
              "displayName": "GitHub Repository Link",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Bonus Deadline",
              "displayName": "Bonus Deadline",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Before Bonus Deadline",
              "displayName": "Before Bonus Deadline",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Bonus Points",
              "displayName": "Bonus Points",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Questions Solved",
              "displayName": "Questions Solved",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Points On Questions",
              "displayName": "Points On Questions",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Total Points",
              "displayName": "Total Points",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Comments",
              "displayName": "Comments",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        160,
        976
      ],
      "id": "9ea4ceee-26d6-48aa-b08c-81fec19b955c",
      "name": "UpdateSheetAfterCheckingCode",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ESyxcs0O4rMH4zxb",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Get a repository in GitHub",
        "authentication": "oAuth2",
        "resource": "repository",
        "operation": "get",
        "owner": {
          "__rl": true,
          "value": "={{ $('\"Solution Submissions\"').item.json['GitHub Repository Link'].match(/github\\.com\\/([^\\/]+)/)[1] }}",
          "mode": "name"
        },
        "repository": {
          "__rl": true,
          "value": "={{ $('\"Solution Submissions\"').item.json['GitHub Repository Link'] }}",
          "mode": "url"
        }
      },
      "type": "n8n-nodes-base.githubTool",
      "typeVersion": 1.1,
      "position": [
        320,
        1056
      ],
      "id": "f326eccc-6a2f-47ab-8ede-00db19ba1efd",
      "name": "RepositoryGitHub",
      "webhookId": "d3b2b7fb-a2c6-4c19-8c18-f7ac10df4c06",
      "credentials": {
        "githubOAuth2Api": {
          "id": "pC1gNlQZpEEST8wv",
          "name": "GitHub account"
        }
      }
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyHour"
            }
          ]
        },
        "documentId": {
          "__rl": true,
          "value": "1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM",
          "mode": "list",
          "cachedResultName": "Participants Data",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1667173423,
          "mode": "list",
          "cachedResultName": "Solution Submissions",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM/edit#gid=1667173423"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "typeVersion": 1,
      "position": [
        -624,
        752
      ],
      "id": "a1d24497-2c35-4666-aa7e-18af77ef9eb4",
      "name": "\"Solution Submissions\"",
      "credentials": {
        "googleSheetsTriggerOAuth2Api": {
          "id": "OlFQWoJ26ACIvlXF",
          "name": "Google Sheets Trigger account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -112,
        1104
      ],
      "id": "5aafdeee-7a2e-4c79-9bca-2406791a1ae1",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "EAIXtsGSK9EClsNv",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "amount": 20
      },
      "id": "9f6c6270-6cd1-4191-82ec-a6674110e36e",
      "name": "Wait 20 Seconds for Rate Limit",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        544,
        752
      ],
      "webhookId": "be02da1d-bf48-4654-9651-f1fbf72a42a8"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Workflow Configuration').item.json['Email Address'] }}",
        "contextWindowLength": 3
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        992,
        720
      ],
      "id": "2ab3d6dd-e98c-4442-ab07-f2e79db6722a",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM",
          "mode": "list",
          "cachedResultName": "Participants Data",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 724822279,
          "mode": "list",
          "cachedResultName": "Challenges",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM/edit#gid=724822279"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        736,
        1008
      ],
      "id": "a6d08f14-f8ae-4559-a054-ffa8bece2ea9",
      "name": "\"Challenges\"1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ESyxcs0O4rMH4zxb",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM",
          "mode": "list",
          "cachedResultName": "Participants Data",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 724822279,
          "mode": "list",
          "cachedResultName": "Challenges",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S1baIh6HY5comV0Kf4oQkpzk8jqOj-4TxRhI8RZwfcM/edit#gid=724822279"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -400,
        752
      ],
      "id": "2039b0ce-37e1-4cc1-87f3-4da7d8aa9e90",
      "name": "\"Challenges\"",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ESyxcs0O4rMH4zxb",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -208,
        752
      ],
      "id": "61b555e8-1342-47ee-9ece-01eae6439a93",
      "name": "Loop Over Items"
    }
  ],
  "pinData": {},
  "connections": {
    "UpdateSheetAfterCheckingCode": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "RepositoryGitHub": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Wait 20 Seconds for Rate Limit",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 20 Seconds for Rate Limit": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "\"Solution Submissions\"": {
      "main": [
        [
          {
            "node": "\"Challenges\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        []
      ]
    },
    "\"Challenges\"1": {
      "ai_tool": [
        []
      ]
    },
    "\"Challenges\"": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "7fa9449f-cc94-4f0a-aa8f-e26f8cf24083",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4c5016c82749dc5bb58bf679c6b9a57f48d2a7f0edadbb1da80353d373de58a2"
  },
  "id": "t7lO0h8w_99Tez7C46WKM",
  "tags": []
}